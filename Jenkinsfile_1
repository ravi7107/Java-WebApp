def s3_source = "s3://mys301082023/WebApp.war"
def s3_dest = "/home/ubuntu/deploy_server/tomcat/webapps/WebApp.war"

pipeline {
  agent {label "deploy_server"}
  
  stages {
  
    stage ("Delete the old maven package") {
      steps {
        print ("Deleting the old maven package")
        sh "rm -rf /home/ubuntu/deploy_server/tomcat/webapps/WebApp.war"
      }
    }
    
    stage ("Download the maven package from S3 bucket") {
      steps {
      
        //Download and copy the maven package
        print ("Downloading the maven package from S3 bucket")
        sh "aws s3 cp ${s3_source} ${s3_dest}"
      }
    }
  }
}
